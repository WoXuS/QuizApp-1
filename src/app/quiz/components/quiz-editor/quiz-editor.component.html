<ng-container>
  <h1>Edycja quizu</h1>
  <form class="form-container" [formGroup]="form">
    <div class="inline-input">
      <h3>{{ "quiz.editor.name" | translate }}</h3>
      <mat-form-field appearance="outline">
        <input matInput formControlName="name" />
        <mat-error *ngIf="form.get('name')?.invalid">{{ "quiz.editor.nameHint" | translate }}</mat-error>
      </mat-form-field>
    </div>

    <div class="full-length">
      <mat-form-field appearance="outline">
        <mat-label>{{ "quiz.editor.description" | translate }}</mat-label>
        <textarea matInput
          formControlName="description"
          placeholder="{{ 'quiz.editor.description' | translate }}"></textarea>
      </mat-form-field>
    </div>

    <div class="settings">
      <mat-accordion>
        <mat-expansion-panel>
          <mat-expansion-panel-header>
            <mat-panel-title>{{ 'quiz.editor.settings' | translate }}</mat-panel-title>
          </mat-expansion-panel-header>

          <div class="setting-block">
            <mat-slide-toggle color="primary" formControlName="randomOrder">{{ 'quiz.editor.randomOrder' | translate }}</mat-slide-toggle>
          </div>
          <div class="setting-block">
            <mat-slide-toggle color="primary" formControlName="movingBetween">{{ 'quiz.editor.movingBetween' | translate }}</mat-slide-toggle>
          </div>
          <div class="setting-block">
            <mat-slide-toggle color="primary" formControlName="showCorrect">{{ 'quiz.editor.showCorrect' | translate }}</mat-slide-toggle>
          </div>
        </mat-expansion-panel>
      </mat-accordion>
    </div>

    <h3>{{ 'quiz.editor.questions' | translate }}</h3>

    <div class="questions">
      <ng-container *ngFor="let question of questionsFormArray.controls">
        <mat-card class="question">
          <mat-card-content>
            <form [formGroup]="getFormGroup(question)">
              <div class="inline-input">
                <h3>{{ "quiz.editor.questionContent" | translate }}</h3>
                <mat-form-field appearance="outline">
                  <input matInput formControlName="content" />
                  <mat-error *ngIf="question.get('content')?.invalid">{{ "quiz.editor.questionContentHint" | translate }}</mat-error>
                </mat-form-field>
              </div>
            </form>
          </mat-card-content>

          <div class="answers">
            <mat-accordion>
              <mat-expansion-panel expanded>
                <mat-expansion-panel-header>
                  <mat-panel-title>{{ 'quiz.editor.answers' | translate }}</mat-panel-title>
                </mat-expansion-panel-header>

                <ng-container *ngFor="let answer of getFormArray(question.get('answers')).controls">
                  <form [formGroup]="getFormGroup(answer)">
                    <div class="inline-input">
                      <mat-form-field appearance="outline">
                        <mat-label>{{ "quiz.editor.answerContent" | translate }}</mat-label>
                        <input matInput formControlName="content" />
                        <mat-error *ngIf="answer.get('content')?.invalid">{{ "quiz.editor.answerContentHint" | translate }}</mat-error>
                      </mat-form-field>
                      <mat-slide-toggle color="primary" formControlName="isCorrect">{{ 'quiz.editor.answerIsCorrect' | translate }}</mat-slide-toggle>
                    </div>
                  </form>
                </ng-container>

                <button mat-stroked-button (click)="addAnswer(getFormArray(question.get('answers')))">{{ 'quiz.editor.addAnswer' | translate }}</button>
              </mat-expansion-panel>
            </mat-accordion>
          </div>
        </mat-card>
      </ng-container>
    </div>

    <button mat-stroked-button (click)="addQuestion()">{{ 'quiz.editor.addQuestion' | translate }}</button>

    <div class="footer">
      <mat-divider></mat-divider>

      <button mat-raised-button color="primary" (click)="saveChanges()">{{ "quiz.editor.saveChanges" | translate }}</button>
      <button mat-stroked-button>{{ "quiz.editor.cancelEdit" | translate }}</button>
    </div>
  </form>
</ng-container>
